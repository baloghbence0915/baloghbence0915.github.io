(this["webpackJsonpvr-project"]=this["webpackJsonpvr-project"]||[]).push([[0],{27:function(t,e,n){},29:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var o=n(8),i=n.n(o),a=n(21),s=n.n(a),r=(n(27),n(12)),c=n(0),l=n(2),u=n(3),p=n(11),b="startGame",d=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,b,{detail:t})}return n}(Object(p.a)(CustomEvent)),h="stopGame",v=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,h,{detail:t})}return n}(Object(p.a)(CustomEvent)),j="updateExportMode",f=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,j,{detail:t})}return n}(Object(p.a)(CustomEvent)),w="updateScore",m=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,w,{detail:t})}return n}(Object(p.a)(CustomEvent)),x=n(18),O=n(10),g=n(6),y=n(22),E=n.n(y);var N,k,L,C,S,P,A=n(1),z=[[3.3863,-5.453,-2.9138,2.0849],[-2.9743,-1.9813,-3.1036,-.1795]],F=[[-3.5435,6.7233,-3.7508],[3.5977,-6.8018,3.7775]],M=function(){function t(e,n){var o=this;Object(c.a)(this,t),this.jump=e,this.counter=0,this.logNeg=[],this.logPos=[],this.isExport=!1,n.addEventListener(b,(function(){o.logPos=[],o.logNeg=[]})),n.addEventListener(h,(function(){var t=Math.floor(o.logNeg.length/o.logPos.length),e=o.logNeg.filter((function(e,n){return n%t===0}));o.isExport&&o.download([].concat(Object(O.a)(o.logPos),Object(O.a)(e)),"game_dataset.csv","csv")})),n.addEventListener(j,(function(t){o.isExport=t.detail.isExport}))}return Object(A.a)(t,[{key:"calculateNextStep",value:function(t){var e=Object(r.a)(t,3),n=e[0],o=e[1],i=e[2],a=[[1],[n=(n-.263511)/.418019+.1],[o=(o- -.019494)/.029002100000000003],[i=(i-.200431)/(.39999-.200431)]];a[0]=a[0].map((function(t){return t>1?1:t<0?0:t})),a[1]=a[1].map((function(t){return t>1?1:t<0?0:t})),a[2]=a[2].map((function(t){return t>1?1:t<0?0:t}));var s=[[1]].concat(Object(O.a)(R(U(z,a)))),c=R(U(F,s)),l=c[0][0],u=c[1][0];console.log(l,u),l>u&&this.jump()}},{key:"savePlay",value:function(t){var e=t.length-1,n=t[e];t[e]=n?1:2;var o=t.join(";")+"\n";n?this.logPos.push(o):this.logNeg.push(o)}},{key:"download",value:function(t,e,n){var o=new Blob(t,{type:n}),i=document.createElement("a"),a=URL.createObjectURL(o);i.href=a,i.download=e,document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i),window.URL.revokeObjectURL(a)}),0)}}]),t}();function U(t,e){for(var n=t.length,o=t[0].length,i=(e.length,e[0].length),a=new Array(n),s=0;s<n;++s){a[s]=new Array(i);for(var r=0;r<i;++r){a[s][r]=0;for(var c=0;c<o;++c)a[s][r]+=t[s][c]*e[c][r]}}return a}function R(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[0].length;n++)t[e][n]=1/(1+Math.pow(Math.E,-1*t[e][n]));return t}var T,X,Y,Z,B=function(t){},G=!1,H=!1,I={offset:{x:0,y:.5},ball:{radius:.05},wall:{width:.05,height:1,step:.5,amount:10},speed:1},J={vel:{x:.5,y:0}};function W(t){var e,n;T=t,(S=new g.n).setSize(window.innerWidth,window.innerHeight),T.appendChild(S.domElement);var o=function(t){var e=new g.k(45,2,.1,10);e.position.z=1.7,e.position.x=t.offset.x,e.position.y=t.offset.y;var n=new g.i(new g.d(2,1,1),new g.j({side:g.c}));n.position.x=t.offset.x,n.position.y=t.offset.y;var o=new g.i(new g.m(t.ball.radius,20,20),new g.j);o.position.x=t.offset.x,o.position.y=t.offset.y;for(var i=[],a=0;a<10;a++){var s=new g.i(new g.d(t.wall.width,t.wall.height,1),new g.j);s.position.x=2;var r=new g.i(new g.d(t.wall.width,t.wall.height,1),new g.j);r.position.x=2,i.push({top:s,bottom:r})}new g.b(5);var c=new g.a(4210752),l=new Float32Array([0,0,0,.4,.2,.2]),u=new g.f;u.setAttribute("position",new g.e(l,3));var p=new Float32Array([0,0,0,.4,.2,.2]),b=new g.f;b.setAttribute("position",new g.e(p,3));var d={top:new g.g(u,new g.h({color:16776960})),bottom:new g.g(b,new g.h({color:16776960}))};return d.top.geometry.setAttribute("position",new g.e(l,3)),[{camera:e,box:n,ball:o,light:c},i,d]}(I);k=o[0],L=o[1],C=o[2],(e=N=new g.l).add.apply(e,Object(O.a)(Object.values(k))),(n=N).add.apply(n,Object(O.a)(L.map((function(t){return[t.top,t.bottom]})).reduce((function(t,e){return[].concat(Object(O.a)(t),Object(O.a)(e))}),[]))),(P=new E.a).showPanel(0),T.appendChild(P.dom),window.addEventListener("resize",K,!1),S.setAnimationLoop(tt),Y=new M(Q,t),T.addEventListener(b,_)}function D(){var t=.2*Math.random()+.2;return{bottom:t,top:t+.4}}function _(t){H=t.detail,window.addEventListener("keydown",Q,!1),window.addEventListener("touchstart",Q,!1),Z=Object(x.a)(Object(x.a)({},J),{},{vel:Object(x.a)({},J.vel)}),k.ball.position.y=I.offset.y,k.ball.position.x=I.offset.x,Z.obstacles=[];for(var e=0;e<10;e++){var n={x:.5+I.wall.step*e},o=D();Z.obstacles[e]={pos:n,range:o,isNext:0===e};var i=L[e],a=i.bottom,s=i.top;a.position.x=n.x,a.position.y=o.bottom-I.wall.height/2,s.position.x=n.x,s.position.y=o.top+I.wall.height/2,a.material.wireframe=!1,s.material.wireframe=!1,L[e].isNext=!0}X=0,B=V}function q(){window.removeEventListener("keydown",Q,!1),window.removeEventListener("touchstart",Q,!1),T.dispatchEvent(new v(X)),B=function(t){}}function K(){S.setSize(window.innerWidth,window.innerHeight)}function Q(){G=!0}function V(t){if(k.ball.position.y>.05&&k.ball.position.y<.95){var e=L.find((function(t){return t.isNext}));if(!H&&Y.savePlay([k.ball.position.y,Z.vel.y,e.bottom.position.y+I.wall.height/2,G]),H&&Y.calculateNextStep([k.ball.position.y,Z.vel.y,e.bottom.position.y+I.wall.height/2]),G&&(Z.vel.y=.01*I.speed),G=!1,Z.vel.y-=.03*t,k.ball.position.y+=Z.vel.y,L.forEach((function(e){var n=e.bottom.position.x;if(e.bottom.position.x-=Z.vel.x*t,e.top.position.x-=Z.vel.x*t,Math.abs(e.bottom.position.x)<I.ball.radius+I.wall.width/2){var o=e.bottom.position.y+I.wall.height/2,i=e.top.position.y-I.wall.height/2;if(k.ball.position.y-o<I.ball.radius)return void q();if(i-k.ball.position.y<=I.ball.radius)return void q()}n>=0&&e.bottom.position.x<=0&&(e.isNext=!1,X++,Z.vel.x+=5e-4,T.dispatchEvent(new m({score:X,speed:Z.vel.x})))})),L[0].bottom.position.x<-1.1){var n=L[I.wall.amount-1],o=L.shift();o.bottom.position.x=n.bottom.position.x+I.wall.step,o.top.position.x=n.bottom.position.x+I.wall.step,o.bottom.material.wireframe=!1,o.top.material.wireframe=!1,o.isNext=!0;var i=D();o.bottom.position.y=i.bottom-I.wall.height/2,o.top.position.y=i.top+I.wall.height/2,L.push(o)}var a=C.top.geometry.attributes.position;a.setXYZ(0,k.ball.position.x,k.ball.position.y,k.ball.position.z),a.setXYZ(1,e.top.position.x,e.top.position.y-I.wall.height/2,e.top.position.z),a.needsUpdate=!0;var s=C.bottom.geometry.attributes.position;s.setXYZ(0,k.ball.position.x,k.ball.position.y,k.ball.position.z),s.setXYZ(1,e.bottom.position.x,e.bottom.position.y+I.wall.height/2,e.bottom.position.z),s.needsUpdate=!0}else q()}var $=0;function tt(t){var e=t/1e3;B((e-$)*I.speed),$=e,P.update(),S.render(N,k.camera)}n(29);var et=n(5);var nt=function(){var t=Object(o.useRef)(null),e=Object(o.useState)(!1),n=Object(r.a)(e,2),i=n[0],a=n[1],s=Object(o.useState)(!1),c=Object(r.a)(s,2),l=c[0],u=c[1],p=Object(o.useState)(!1),b=Object(r.a)(p,2),v=b[0],j=b[1],m=Object(o.useState)(null),x=Object(r.a)(m,2),O=x[0],g=x[1],y=Object(o.useState)(null),E=Object(r.a)(y,2),N=E[0],k=E[1];function L(t){a(!1),g(t.detail)}function C(t){g(t.detail.score),k(t.detail.speed)}return Object(o.useEffect)((function(){t.current&&(t.current.addEventListener(h,L),t.current.addEventListener(w,C),W(t.current))}),[]),Object(o.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.dispatchEvent(new f({isExport:v&&!l}))}),[l,v]),Object(et.jsxs)("div",{className:"App",children:[Object(et.jsx)("div",{className:"game ".concat(i?"":"blurred"),ref:t}),i?Object(et.jsxs)("div",{className:"dashboard",children:[Object(et.jsxs)("h3",{children:[O||0," points"]}),Object(et.jsxs)("h4",{children:[(N||0).toFixed(4)," speed"]})]}):Object(et.jsx)("div",{className:"menu",children:Object(et.jsxs)("div",{className:"popup",children:[null!==O?Object(et.jsxs)(et.Fragment,{children:[Object(et.jsxs)("h1",{children:[O," points"]}),Object(et.jsx)("h2",{children:"Try again!"})]}):Object(et.jsx)("h2",{children:"Let's get started! "}),Object(et.jsx)("button",{className:"button purple",onClick:function(){var e;a(!0),t.current&&(null===(e=t.current)||void 0===e||e.dispatchEvent(new d(l))),g(null),k(null)},children:"Play"}),Object(et.jsx)("br",{}),Object(et.jsx)("br",{}),Object(et.jsx)("br",{}),Object(et.jsxs)("label",{className:"container",children:["Machine mode",Object(et.jsx)("input",{type:"checkbox",checked:l,onChange:function(){return u(!l)}}),Object(et.jsx)("span",{className:"checkmark"})]}),Object(et.jsx)("br",{}),Object(et.jsxs)("label",{className:"container",children:["Export game data",Object(et.jsx)("input",{disabled:l,type:"checkbox",checked:v,onChange:function(){return j(!v)}}),Object(et.jsx)("span",{className:"checkmark"})]})]})})]})},ot=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(e){var n=e.getCLS,o=e.getFID,i=e.getFCP,a=e.getLCP,s=e.getTTFB;n(t),o(t),i(t),a(t),s(t)}))};s.a.render(Object(et.jsx)(i.a.StrictMode,{children:Object(et.jsx)(nt,{})}),document.getElementById("root")),ot()}},[[31,1,2]]]);
//# sourceMappingURL=main.08a25c06.chunk.js.map